import{Dc as p,Eb as a,Fb as n,Jb as l,Lb as d,Sa as h,_b as c,ab as u,dd as w,fb as g,sa as s,zc as v}from"./chunk-72XR24T2.js";var f=class m{constructor(e){this.$viewerService=e;this.$viewerService.viewerHasLoaded()&&(this.camHeightKm.set(Number((p.fromCartesian(this.$viewerService.startCamDestination).height/1e3).toFixed(1))),this.$viewerService.viewer.scene.camera.changed.addEventListener(this.setCamHeightKm))}ngOnDestroy(){this.$viewerService.viewer.scene.camera.changed.removeEventListener(this.setCamHeightKm)}camHeightKm=s(3e3);setCamHeightKm=()=>{this.$viewerService.viewer.scene.camera.pitch>.12&&this.camFly(.1,.1,.12);let e=this.getCamHeightKm();this.camHeightKm()<.1?(this.camFly(.1,.3),this.camHeightKm.set(.1)):this.camHeightKm.set(e)};getCamHeightKm(){let e=this.$viewerService.viewer.scene.camera.positionCartographic,t;return e.height>=1e3?t=Number((e.height/1e3).toFixed(1)):t=Number((e.height/1e3).toFixed(3)),t}async camFly(e,t=1,r=void 0){try{if(typeof e!="number")return;let i=1;e<.1?i=100:i=e*1e3;let o=this.$viewerService.viewer.camera.positionCartographic.longitude,C=this.$viewerService.viewer.camera.positionCartographic.latitude,b=this.$viewerService.viewer.camera.heading,y=r||this.$viewerService.viewer.camera.pitch,H=this.$viewerService.viewer.camera.roll;await this.$viewerService.viewer.camera.flyTo({destination:v.fromRadians(o,C,i),maximumHeight:i,orientation:{heading:b,pitch:y,roll:H},duration:t,complete:()=>{this.camHeightKm.set(i/1e3)}})}catch(i){console.log(i)}}static \u0275fac=function(t){return new(t||m)(u(w))};static \u0275cmp=g({type:m,selectors:[["camera-height-tool"]],decls:6,vars:1,consts:[[1,"camera-height-container"],["type","number","name","camera-height-input","min","0.1",3,"change","value"]],template:function(t,r){t&1&&(a(0,"div",0)(1,"span"),c(2,"\u0412\u044B\u0441\u043E\u0442\u0430 \u043D\u0430\u0431\u043B\u044E\u0434\u0435\u043D\u0438\u044F:\xA0"),n(),a(3,"input",1),d("change",function(o){return r.camFly(+o.target.value)}),n(),a(4,"span"),c(5,"\xA0\u043A\u043C"),n()()),t&2&&(h(3),l("value",r.camHeightKm()))},styles:[".camera-height-container[_ngcontent-%COMP%]{display:flex;position:absolute;left:200px;bottom:15px;height:var(--regular-btn-size);width:max-content;align-items:center;justify-content:center;background-color:var(--theme-ui-background-color);border-radius:10px;padding:5px 10px;box-sizing:border-box;outline:1px solid var(--theme-outline-color);z-index:101}.camera-height-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:max-content;-webkit-user-select:none;user-select:none}.camera-height-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:inline-block;font-size:1em;width:5em;padding:2px 5px;background-color:var(--theme-inputs-background-color)}"],changeDetection:0})};export{f as CameraHeightTool};
